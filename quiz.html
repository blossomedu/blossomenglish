<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë‹¨ì–´ í•™ìŠµ</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard/dist/web/variable/pretendardvariable.css">
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: "Pretendard Variable", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f7fb;
      color: #111827;
    }
    .container {
      max-width: 1100px;
      margin: 40px auto;
      padding: 0 20px;
    }
    .breadcrumb {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 4px;
    }
    h1 {
      font-size: 30px;
      font-weight: 800;
      margin: 0 0 4px;
    }
    .subtitle {
      font-size: 15px;
      color: #6b7280;
      margin-bottom: 22px;
    }
    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
    }
    .modes {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .mode-btn {
      border: none;
      border-radius: 999px;
      padding: 9px 18px;
      background: #e5e7eb;
      color: #374151;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: 0.18s ease;
    }
    .mode-btn span.icon {
      font-size: 17px;
    }
    .mode-btn.active {
      background: #2563eb;
      color: #ffffff;
      box-shadow: 0 10px 24px rgba(37, 99, 235, 0.35);
    }
    .mode-btn:hover {
      transform: translateY(-1px);
    }
    .speaker-btn {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      background: #e5f0ff;
      color: #1d4ed8;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
    }
    .speaker-btn span {
      font-size: 17px;
    }
    .card {
      margin-top: 22px;
      background: #ffffff;
      border-radius: 26px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      padding: 32px 34px 30px;
      min-height: 260px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .word-main {
      text-align: center;
      margin-top: 10px;
      margin-bottom: 24px;
    }
    .word-main .en {
      font-size: 52px;
      font-weight: 800;
      margin-bottom: 12px;
    }
    .word-main .ko {
      font-size: 24px;
      color: #4b5563;
    }
    .bottom-info {
      font-size: 15px;
      color: #6b7280;
      text-align: center;
      margin-top: 8px;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 28px;
      gap: 12px;
    }
    .index-text {
      font-size: 14px;
      color: #6b7280;
    }
    .nav-btns {
      display: flex;
      gap: 10px;
    }
    .btn {
      border-radius: 999px;
      padding: 8px 16px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .btn-outline {
      background: #eef2ff;
      color: #4f46e5;
    }
    .btn-primary {
      background: #2563eb;
      color: #fff;
      box-shadow: 0 10px 24px rgba(37, 99, 235, 0.4);
    }
    /* ê³µí†µ ì„ íƒì§€ ì˜ì—­ */
    .choice-area {
      margin-top: 10px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .choice-btn {
      padding: 12px 14px;
      border-radius: 18px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      cursor: pointer;
      font-size: 15px;
      text-align: left;
      transition: 0.16s ease;
    }
    .choice-btn:hover {
      background: #eef2ff;
      border-color: #4f46e5;
    }
    .choice-btn.correct {
      background: #dcfce7;
      border-color: #16a34a;
      color: #14532d;
    }
    .choice-btn.wrong {
      background: #fee2e2;
      border-color: #dc2626;
      color: #7f1d1d;
    }
    .feedback {
      margin-top: 8px;
      font-size: 14px;
      text-align: center;
    }
    .feedback.ok {
      color: #15803d;
    }
    .feedback.no {
      color: #b91c1c;
    }
    /* ë¬¸ì¥ ë¹ˆì¹¸ */
    .sentence-ko {
      font-size: 15px;
      color: #6b7280;
      margin-top: 4px;
      text-align: center;
    }
    .input-row {
      margin-top: 18px;
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    .input-row input {
      padding: 8px 10px;
      min-width: 160px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      font-size: 15px;
      text-align: center;
      outline: none;
    }
    .input-row input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.25);
    }
    @media (max-width: 720px) {
      .card {
        padding: 24px 20px;
      }
      .word-main .en {
        font-size: 40px;
      }
      .word-main .ko {
        font-size: 20px;
      }
      .choice-area {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="breadcrumb" id="breadcrumb">1ë‹¨ê³„ Â· 1 ìœ ë‹›</div>
    <h1 id="title">1 ë‹¨ì–´ í•™ìŠµ</h1>
    <p class="subtitle">ë‹¨ì–´ í•™ìŠµ ëª¨ë“œë¥¼ ì„ íƒí•´ ë³´ì„¸ìš”.</p>

    <div class="top-row">
      <div class="modes">
        <button class="mode-btn active" data-mode="vocab">
          <span class="icon">ğŸ“š</span> ì–´íœ˜ í•™ìŠµ
        </button>
        <button class="mode-btn" data-mode="meaning">
          <span class="icon">âœ…</span> ëœ» ì°¾ê¸°
        </button>
        <button class="mode-btn" data-mode="english">
          <span class="icon">ğŸ”¤</span> ì˜ì–´ ì°¾ê¸°
        </button>
        <button class="mode-btn" data-mode="listening">
          <span class="icon">ğŸ§</span> ë“£ê³  ì°¾ê¸°
        </button>
        <button class="mode-btn" data-mode="sentence">
          <span class="icon">âœï¸</span> ë¬¸ì¥ ë¹ˆì¹¸
        </button>
      </div>

      <button class="speaker-btn" id="speakBtn">
        <span>ğŸ”Š</span> ë‹¤ì‹œ ë“£ê¸°
      </button>
    </div>

    <div class="card" id="quizCard">
      <!-- JSê°€ ì—¬ê¸° ë‚´ìš©ì„ ì±„ì›Œ ì¤ë‹ˆë‹¤ -->
    </div>
  </div>

  <script>
    // 1) URLì—ì„œ ë‹¨ê³„/ìœ ë‹› ì½ê¸°
    const params = new URLSearchParams(window.location.search);
    const stage = params.get("stage") || "1";
    const unit = params.get("unit") || "1";

    document.getElementById("breadcrumb").innerText = `${stage}ë‹¨ê³„ Â· ${unit} ìœ ë‹›`;
    document.getElementById("title").innerText = `${unit} ë‹¨ì–´ í•™ìŠµ`;

    // 2) 1-1ìš© ë‹¨ì–´ 10ê°œ (ë‚˜ì¤‘ì— ì´ ë¶€ë¶„ë§Œ ì—‘ì…€/JSONìœ¼ë¡œ ë°”ê¾¸ë©´ ë¨)
    const words = [
      {
        word: "at",
        meaning: "~ì—",
        phraseEn: "at 7 o'clock",
        phraseKo: "7ì‹œ ì •ê°ì—",
        sentenceEn: "I get up at 7 o'clock.",
        sentenceKo: "ë‚˜ëŠ” 7ì‹œ ì •ê°ì— ì¼ì–´ë‚˜."
      },
      {
        word: "bat",
        meaning: "ì•¼êµ¬ë°©ë§ì´, ë°•ì¥",
        phraseEn: "I have a bat.",
        phraseKo: "ë‚˜ëŠ” ì•¼êµ¬ ë°©ë§ì´ë¥¼ ê°€ì§€ê³  ìˆì–´.",
        sentenceEn: "I have a bat.",
        sentenceKo: "ë‚˜ëŠ” ì•¼êµ¬ ë°©ë§ì´ë¥¼ ê°€ì§€ê³  ìˆì–´."
      },
      {
        word: "fat",
        meaning: "ëš±ëš±í•œ, ì‚´ì°",
        phraseEn: "a fat cat",
        phraseKo: "ëš±ëš±í•œ ê³ ì–‘ì´",
        sentenceEn: "The cat is fat.",
        sentenceKo: "ê·¸ ê³ ì–‘ì´ëŠ” ëš±ëš±í•´."
      },
      {
        word: "hat",
        meaning: "ëª¨ì",
        phraseEn: "a yellow hat",
        phraseKo: "ë…¸ë€ìƒ‰ ëª¨ì",
        sentenceEn: "She has a hat.",
        sentenceKo: "ê·¸ë…€ëŠ” ëª¨ìë¥¼ ê°€ì§€ê³  ìˆì–´."
      },
      {
        word: "chat",
        meaning: "ì´ì•¼ê¸°í•˜ë‹¤, ìˆ˜ë‹¤ ë–¨ë‹¤",
        phraseEn: "I like to chat.",
        phraseKo: "ë‚˜ëŠ” ì´ì•¼ê¸°í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•´.",
        sentenceEn: "I like to chat with my family.",
        sentenceKo: "ë‚˜ëŠ” ë‚˜ì˜ ê°€ì¡±ê³¼ ëŒ€í™”í•˜ëŠ” ê±¸ ì¢‹ì•„í•´."
      },
      {
        word: "act",
        meaning: "í–‰ë™í•˜ë‹¤, ì—°ê¸°í•˜ë‹¤",
        phraseEn: "act like a kid",
        phraseKo: "ì•„ì´ì²˜ëŸ¼ í–‰ë™í•˜ë‹¤",
        sentenceEn: "She acts like a kid.",
        sentenceKo: "ê·¸ë…€ëŠ” ì•„ì´ì²˜ëŸ¼ í–‰ë™í•´."
      },
      {
        word: "fact",
        meaning: "ì‚¬ì‹¤",
        phraseEn: "a clear fact",
        phraseKo: "ë¶„ëª…í•œ ì‚¬ì‹¤",
        sentenceEn: "In fact, I like him.",
        sentenceKo: "ì‚¬ì‹¤, ë‚˜ëŠ” ê·¸ë¥¼ ì¢‹ì•„í•´."
      },
      {
        word: "fan",
        meaning: "íŒ¬, ì„ í’ê¸°",
        phraseEn: "a big fan",
        phraseKo: "í° ì„ í’ê¸°",
        sentenceEn: "They're fans.",
        sentenceKo: "ê·¸ê²ƒë“¤ì€ ì„ í’ê¸°ì•¼."
      },
      {
        word: "man",
        meaning: "ë‚¨ì, ì‚¬ëŒ",
        phraseEn: "an old man",
        phraseKo: "ë‚˜ì´ ë“  ë‚¨ì",
        sentenceEn: "He is an old man.",
        sentenceKo: "ê·¸ëŠ” ë‚˜ì´ë“  ë‚¨ìì•¼."
      },
      {
        word: "pants",
        meaning: "ë°”ì§€",
        phraseEn: "blue pants",
        phraseKo: "íŒŒë€ìƒ‰ ë°”ì§€",
        sentenceEn: "How much are the pants?",
        sentenceKo: "ê·¸ ë°”ì§€ëŠ” ì–¼ë§ˆì•¼?"
      }
    ];

    // 3) ìƒíƒœ
    let currentIndex = 0;
    let currentMode = "vocab"; // vocab, meaning, english, listening, sentence

    const cardEl = document.getElementById("quizCard");
    const speakBtn = document.getElementById("speakBtn");
    const modeButtons = document.querySelectorAll(".mode-btn");

    // 4) ìŒì„± ì¬ìƒ (ì˜ì–´ 2ë²ˆ)
    function speakWord(text) {
      if (!("speechSynthesis" in window)) return;

      const speakOnce = () => {
        const uttr = new SpeechSynthesisUtterance(text);
        uttr.lang = "en-US";
        uttr.rate = 0.9;
        window.speechSynthesis.speak(uttr);
      };

      speakOnce();
      setTimeout(speakOnce, 1200);
    }

    // 5) ê³µí†µ: ë‹¤ìŒ/ì´ì „ ì´ë™
    function goNext() {
      currentIndex = (currentIndex + 1) % words.length;
      render();
    }
    function goPrev() {
      currentIndex = (currentIndex - 1 + words.length) % words.length;
      render();
    }

    // 6) ëª¨ë“œë³„ ë Œë”ë§
    function render() {
      const w = words[currentIndex];
      cardEl.innerHTML = "";

      if (currentMode === "vocab") {
        renderVocab(w);
      } else if (currentMode === "meaning") {
        renderMeaningQuiz(w);
      } else if (currentMode === "english") {
        renderEnglishQuiz(w);
      } else if (currentMode === "listening") {
        renderListeningQuiz(w);
      } else if (currentMode === "sentence") {
        renderSentenceQuiz(w);
      }

      if (["vocab", "listening"].includes(currentMode)) {
        speakWord(w.word);
      }
    }

    // (1) ì–´íœ˜ í•™ìŠµ: ì˜ì–´ + ëœ» ê°™ì´ ë³´ì—¬ì£¼ê¸°
    function renderVocab(w) {
      const wordBox = document.createElement("div");
      wordBox.className = "word-main";
      wordBox.innerHTML = `
        <div class="en">${w.word}</div>
        <div class="ko">${w.meaning}</div>
      `;

      const phrase = document.createElement("div");
      phrase.className = "bottom-info";
      phrase.innerText = `${w.phraseEn}  Â·  ${w.phraseKo}`;

      const controls = createControls();

      cardEl.appendChild(wordBox);
      cardEl.appendChild(phrase);
      cardEl.appendChild(controls);
    }

    // (2) ëœ» ì°¾ê¸°: ì˜ì–´ ë³´ê³  í•œê¸€ ëœ» ê³ ë¥´ê¸°
    function renderMeaningQuiz(w) {
      const title = document.createElement("div");
      title.className = "word-main";
      title.innerHTML = `
        <div class="en">${w.word}</div>
        <div class="ko" style="font-size:16px;color:#9ca3af;margin-top:8px;">
          ì˜ì–´ë¥¼ ë³´ê³  ì•Œë§ì€ í•œê¸€ ëœ»ì„ ê³¨ë¼ìš”.
        </div>
      `;

      const { area, setFeedback } = createChoiceArea(w, "ko");
      const controls = createControls();

      cardEl.appendChild(title);
      cardEl.appendChild(area);
      cardEl.appendChild(controls);

      // ë‚´ë¶€ì—ì„œ ì •ë‹µ/ì˜¤ë‹µ ì²˜ë¦¬
      function createChoiceArea(wordObj, type) {
        const area = document.createElement("div");
        area.className = "choice-area";
        const feedback = document.createElement("div");
        feedback.className = "feedback";

        // ë³´ê¸° 4ê°œ ë½‘ê¸°
        const indices = new Set([currentIndex]);
        while (indices.size < 4) {
          indices.add(Math.floor(Math.random() * words.length));
        }
        const options = Array.from(indices).sort(() => Math.random() - 0.5);

        options.forEach(idx => {
          const o = words[idx];
          const btn = document.createElement("button");
          btn.className = "choice-btn";
          btn.innerText = type === "ko" ? o.meaning : o.word;

          btn.onclick = () => {
            // ì´ë¯¸ ì„ íƒí–ˆìœ¼ë©´ ë¬´ì‹œ
            if (area.dataset.answered === "true") return;
            area.dataset.answered = "true";

            if (idx === currentIndex) {
              btn.classList.add("correct");
              feedback.className = "feedback ok";
              feedback.innerText = "ì •ë‹µì´ì—ìš”! ğŸ‘";
              setTimeout(goNext, 900);
            } else {
              btn.classList.add("wrong");
              feedback.className = "feedback no";
              feedback.innerText = "ì•„ì‰¬ì›Œìš”. ë‹¤ì‹œ í•œ ë²ˆ ë“¤ì–´ë³¼ê¹Œìš”?";
            }
          };

          area.appendChild(btn);
        });

        cardEl.appendChild(feedback);

        return {
          area,
          setFeedback: (msg, ok = true) => {
            feedback.className = "feedback " + (ok ? "ok" : "no");
            feedback.innerText = msg;
          }
        };
      }
    }

    // (3) ì˜ì–´ ì°¾ê¸°: í•œê¸€ ë³´ê³  ì˜ì–´ ë‹¨ì–´ ê³ ë¥´ê¸°
    function renderEnglishQuiz(w) {
      const title = document.createElement("div");
      title.className = "word-main";
      title.innerHTML = `
        <div class="en" style="font-size:26px;">${w.meaning}</div>
        <div class="ko" style="font-size:16px;color:#9ca3af;margin-top:8px;">
          í•œê¸€ ëœ»ì„ ë³´ê³  ì•Œë§ì€ ì˜ì–´ë¥¼ ê³¨ë¼ìš”.
        </div>
      `;

      const area = document.createElement("div");
      area.className = "choice-area";
      const feedback = document.createElement("div");
      feedback.className = "feedback";

      const indices = new Set([currentIndex]);
      while (indices.size < 4) {
        indices.add(Math.floor(Math.random() * words.length));
      }
      const options = Array.from(indices).sort(() => Math.random() - 0.5);

      options.forEach(idx => {
        const o = words[idx];
        const btn = document.createElement("button");
        btn.className = "choice-btn";
        btn.innerText = o.word;

        btn.onclick = () => {
          if (area.dataset.answered === "true") return;
          area.dataset.answered = "true";

          if (idx === currentIndex) {
            btn.classList.add("correct");
            feedback.className = "feedback ok";
            feedback.innerText = "ì •ë‹µì´ì—ìš”! ğŸ‘";
            setTimeout(goNext, 900);
          } else {
            btn.classList.add("wrong");
            feedback.className = "feedback no";
            feedback.innerText = "ì•„ì‰¬ì›Œìš”. ë‹¤ì‹œ ê³¨ë¼ë³¼ê¹Œìš”?";
          }
        };

        area.appendChild(btn);
      });

      const controls = createControls();

      cardEl.appendChild(title);
      cardEl.appendChild(area);
      cardEl.appendChild(feedback);
      cardEl.appendChild(controls);
    }

    // (4) ë“£ê³  ì°¾ê¸°: ë°œìŒë§Œ ë“£ê³  ëœ» ê³ ë¥´ê¸°
    function renderListeningQuiz(w) {
      const title = document.createElement("div");
      title.className = "word-main";
      title.innerHTML = `
        <div class="en" style="font-size:22px;">ë°œìŒì„ ë“£ê³  ì–´ë–¤ ë‹¨ì–´ì¸ì§€ ë§í˜€ ë³´ì•„ìš”.</div>
        <div class="ko" style="font-size:15px;color:#9ca3af;margin-top:8px;">
          ğŸ”Š ìœ„ì— ìˆëŠ” <b>ë‹¤ì‹œ ë“£ê¸°</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ë¼ìš”.
        </div>
      `;

      const area = document.createElement("div");
      area.className = "choice-area";
      const feedback = document.createElement("div");
      feedback.className = "feedback";

      const indices = new Set([currentIndex]);
      while (indices.size < 4) {
        indices.add(Math.floor(Math.random() * words.length));
      }
      const options = Array.from(indices).sort(() => Math.random() - 0.5);

      options.forEach(idx => {
        const o = words[idx];
        const btn = document.createElement("button");
        btn.className = "choice-btn";
        btn.innerText = o.meaning;

        btn.onclick = () => {
          if (area.dataset.answered === "true") return;
          area.dataset.answered = "true";

          if (idx === currentIndex) {
            btn.classList.add("correct");
            feedback.className = "feedback ok";
            feedback.innerText = `ì •ë‹µ! ${w.word} ì—ìš”.`;
            setTimeout(goNext, 1000);
          } else {
            btn.classList.add("wrong");
            feedback.className = "feedback no";
            feedback.innerText = "ë‹¤ì‹œ ë“¤ì–´ë³´ê³  ê³¨ë¼ ë³´ì!";
          }
        };

        area.appendChild(btn);
      });

      const controls = createControls();

      cardEl.appendChild(title);
      cardEl.appendChild(area);
      cardEl.appendChild(feedback);
      cardEl.appendChild(controls);
    }

    // (5) ë¬¸ì¥ ë¹ˆì¹¸ ë°›ì•„ì“°ê¸°
    function renderSentenceQuiz(w) {
      const blankSentence = w.sentenceEn.replace(
        new RegExp(w.word, "gi"),
        "____"
      );

      const wordBox = document.createElement("div");
      wordBox.className = "word-main";
      wordBox.innerHTML = `
        <div class="en" style="font-size:24px;">${blankSentence}</div>
      `;

      const ko = document.createElement("div");
      ko.className = "sentence-ko";
      ko.innerText = w.sentenceKo;

      const inputRow = document.createElement("div");
      inputRow.className = "input-row";
      const input = document.createElement("input");
      input.placeholder = "ì •ë‹µ ë‹¨ì–´ë¥¼ ì¨ ë³´ì„¸ìš”";
      const btn = document.createElement("button");
      btn.className = "btn btn-outline";
      btn.innerText = "í™•ì¸";

      const feedback = document.createElement("div");
      feedback.className = "feedback";

      btn.onclick = () => {
        const value = input.value.trim().toLowerCase();
        if (!value) return;
        if (value === w.word.toLowerCase()) {
          feedback.className = "feedback ok";
          feedback.innerText = "ì •ë‹µì´ì—ìš”! ğŸ‘";
          setTimeout(goNext, 1000);
        } else {
          feedback.className = "feedback no";
          feedback.innerText = `ì•„ì‰¬ì›Œìš”. ì •ë‹µì€ "${w.word}" ì˜€ì–´ìš”.`;
        }
      };

      inputRow.appendChild(input);
      inputRow.appendChild(btn);

      const controls = createControls();

      cardEl.appendChild(wordBox);
      cardEl.appendChild(ko);
      cardEl.appendChild(inputRow);
      cardEl.appendChild(feedback);
      cardEl.appendChild(controls);
    }

    // ê³µí†µ í•˜ë‹¨ ì»¨íŠ¸ë¡¤
    function createControls() {
      const controls = document.createElement("div");
      controls.className = "controls";

      const indexText = document.createElement("div");
      indexText.className = "index-text";
      indexText.innerText = `${currentIndex + 1} / ${words.length}`;

      const nav = document.createElement("div");
      nav.className = "nav-btns";

      const prev = document.createElement("button");
      prev.className = "btn btn-outline";
      prev.innerText = "ì´ì „";
      prev.onclick = goPrev;

      const next = document.createElement("button");
      next.className = "btn btn-primary";
      next.innerText = "ë‹¤ìŒ";
      next.onclick = goNext;

      nav.appendChild(prev);
      nav.appendChild(next);

      controls.appendChild(indexText);
      controls.appendChild(nav);
      return controls;
    }

    // ëª¨ë“œ ë²„íŠ¼ í´ë¦­
    modeButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        modeButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentMode = btn.dataset.mode;
        currentIndex = 0;
        render();
      });
    });

    // ë‹¤ì‹œ ë“£ê¸° ë²„íŠ¼
    speakBtn.addEventListener("click", () => {
      const w = words[currentIndex];
      speakWord(w.word);
    });

    // ìµœì´ˆ ë Œë”ë§
    render();
  </script>
</body>
</html>