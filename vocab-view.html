<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì–´íœ˜ í•™ìŠµ (ë³´ê¸° ëª¨ë“œ)</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard/dist/web/variable/pretendardvariable.css">

  <style>
    body {
      font-family: "Pretendard Variable", sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f7fb;
    }

    .container {
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px 60px;
    }

    h1 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 16px;
      color: #666;
      margin-bottom: 20px;
    }

    .info {
      font-size: 13px;
      color: #999;
      margin-bottom: 20px;
    }

    .word-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .word-card {
      background: #ffffff;
      border-radius: 18px;
      padding: 12px 16px;
      box-shadow: 0px 4px 14px rgba(0,0,0,0.06);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .word-texts {
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .word-en {
      font-size: 18px;
      font-weight: 700;
    }

    .word-kr {
      font-size: 14px;
      color: #666;
    }

    .play-btn {
      border: none;
      background: #edf2ff;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .play-btn:hover {
      background: #dbe4ff;
    }

    .status {
      font-size: 13px;
      color: #555;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<div class="container">
  <h1 id="title">ì–´íœ˜ í•™ìŠµ</h1>
  <div class="subtitle" id="subtitle">ì˜ì–´ì™€ ëœ»ì„ í•¨ê»˜ ë³´ë©´ì„œ ë“¤ì–´ë³´ì„¸ìš”.</div>
  <div class="info">í˜ì´ì§€ë¥¼ ì—´ë©´ ìœ„ì—ì„œë¶€í„° ìˆœì„œëŒ€ë¡œ ë‹¨ì–´ ë°œìŒì´ ìë™ìœ¼ë¡œ ë‘ ë²ˆì”© ì¬ìƒë¼ìš”.</div>

  <div class="word-list" id="wordList"></div>

  <div class="status" id="statusText"></div>
</div>

<script>
  // 1) unit ë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸° (?unit=1)
  const params = new URLSearchParams(location.search);
  const unit = params.get("unit") || "1";
  document.getElementById("title").innerText = `ì–´íœ˜ í•™ìŠµ - ${unit}ë²ˆ ì„¸íŠ¸`;

  // 2) ë‹¨ì–´ ë°ì´í„° (ì˜ˆì‹œ)
  // ì‹¤ì œë¡œëŠ” ì„ ìƒë‹˜ì´ ì—¬ê¸° ë‹¨ì–´ë§Œ ë°”ê¾¸ë©´ ë¨.
  const vocabData = {
    "1": [
      { en: "apple", kr: "ì‚¬ê³¼" },
      { en: "banana", kr: "ë°”ë‚˜ë‚˜" },
      { en: "park", kr: "ê³µì›" },
      { en: "school", kr: "í•™êµ" },
      { en: "friend", kr: "ì¹œêµ¬" }
    ],
    "2": [
      { en: "dog", kr: "ê°œ" },
      { en: "cat", kr: "ê³ ì–‘ì´" },
      { en: "river", kr: "ê°•" },
      { en: "mountain", kr: "ì‚°" },
      { en: "flower", kr: "ê½ƒ" }
    ]
    // 3,4,... unit ë„ ì´ëŸ° ì‹ìœ¼ë¡œ ì¶”ê°€ ê°€ëŠ¥
  };

  const words = vocabData[unit] || [];

  const listEl = document.getElementById("wordList");
  const statusText = document.getElementById("statusText");

  // 3) í™”ë©´ì— ë‹¨ì–´ ëª©ë¡ ë¿Œë¦¬ê¸°
  words.forEach((item, index) => {
    const card = document.createElement("div");
    card.className = "word-card";

    const texts = document.createElement("div");
    texts.className = "word-texts";

    const en = document.createElement("div");
    en.className = "word-en";
    en.innerText = item.en;

    const kr = document.createElement("div");
    kr.className = "word-kr";
    kr.innerText = item.kr;

    texts.appendChild(en);
    texts.appendChild(kr);

    const btn = document.createElement("button");
    btn.className = "play-btn";
    btn.innerHTML = "ğŸ”Š ë‹¤ì‹œ ë“£ê¸°";
    btn.onclick = () => speakWordTwice(item.en);

    card.appendChild(texts);
    card.appendChild(btn);

    listEl.appendChild(card);
  });

  // 4) ë‹¨ì–´ ë°œìŒ í•¨ìˆ˜ (2ë²ˆì”© ì¬ìƒ)
  function speakWordTwice(word) {
    if (!("speechSynthesis" in window)) {
      alert("ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìŒì„± ì¬ìƒì„ ì§€ì›í•˜ì§€ ì•Šì•„ìš” ğŸ˜¢");
      return;
    }

    const speakOnce = () => {
      const u = new SpeechSynthesisUtterance(word);
      u.lang = "en-US";
      u.rate = 0.9;
      window.speechSynthesis.speak(u);
    };

    window.speechSynthesis.cancel();
    speakOnce();
    setTimeout(speakOnce, 800); // 0.8ì´ˆ ë’¤ í•œ ë²ˆ ë”
  }

  // 5) ìœ„ì—ì„œë¶€í„° ìˆœì„œëŒ€ë¡œ ìë™ ì¬ìƒ
  async function playAllWordsAuto() {
    if (words.length === 0) {
      statusText.innerText = "ë“±ë¡ëœ ë‹¨ì–´ê°€ ì—†ì–´ìš”.";
      return;
    }

    statusText.innerText = "ìë™ ì¬ìƒ ì¤‘...";

    // ë¸Œë¼ìš°ì €ì—ì„œ voice ëª©ë¡ ë¡œë”©ì„ ê¸°ë‹¤ë ¤ì£¼ëŠ” í¸ì´ ì¢‹ìŒ
    if ("speechSynthesis" in window) {
      window.speechSynthesis.cancel();
    }

    for (let i = 0; i < words.length; i++) {
      const w = words[i].en;
      statusText.innerText = `ìë™ ì¬ìƒ: ${i + 1} / ${words.length} (${w})`;
      speakWordTwice(w);
      // ë‹¨ì–´ í•˜ë‚˜(2ë²ˆ ì½ê¸°) ëë‚  ì‹œê°„ + ì—¬ìœ  ì‹œê°„
      await sleep(2200);
    }

    statusText.innerText = "ìë™ ì¬ìƒì´ ëë‚¬ì–´ìš”. ë‹¤ì‹œ ë“£ê³  ì‹¶ìœ¼ë©´ ğŸ”Š ë²„íŠ¼ì„ ëˆŒëŸ¬ìš”.";
  }

  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  // í˜ì´ì§€ ë¡œë“œ í›„ ìë™ ì¬ìƒ ì‹œì‘
  window.addEventListener("load", () => {
    playAllWordsAuto();
  });
</script>

</body>
</html>
